##Using the Cloudstack Compute provider

Creating a client is straight-forward:

```Javascript
var client = require('pkgcloud').compute.createClient({
    provider: 'cloudstack',
    apiUri: 'https://your-cloudstack-api-uri',
    apiKey: 'your-cloudstack-apiKey',
    apiSecret: 'your-cloudstack-apiSecret'
});
```

[More options for creating clients](README.md)

### API Methods

Several Cloudstack API methods are asynchronous and generates a job. Cloudstack provides a common method API to retrieve jobs, thus allowing to track the progress of any asynchronous methods.

As such, the Cloudstack provider in pkgcloud is developed so that asynchronous methods can return continuously a job, then return the final result once the job is completed. This is optionnally done by providing a progressCallback function, along the standard callback.

Example: createServer (Cloudstack's deployVirtualMachine) returns continuously a job id. The job, once completed, contains all the server information from Cloudstack (i.e. not only the user-specified options).


### Servers

#### client.getServers(callback)
Lists all servers that are available to use on your Cloudstack account

Callback returns `f(err, servers)` where `servers` is an `Array`

#### client.createServer(options, callback, progressCallback)

_Asynchronous method_

Creates a server with the options specified

Options are as follows:

```js
{
  name: 'serverName', // required
  flavor: 'flavor1',  // required - {object|String}  service offering
  image: 'image1',    // required - {object|String}  template
  zone: 'zone1',      // optional - {object|String}  zone | default: zone where template is deployed
  networksids: []     // optional - {Array|String}   array of networks | default: network where zone is deployed
}
```
Returns the server generated with specified options in the callback `f(err, server)`

(A): Returns regularly the job generated by the call in the progressCallback `f(err, job)`. Once job is completed, returns the server generated with complete Cloudstack information in the callback `f(err, server)`

